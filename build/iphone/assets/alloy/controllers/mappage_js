function __processArg(t,e){var i=null;return t&&(i=t[e]||null,delete t[e]),i}function Controller(){function t(){o=0,l.show(),c.height="70%"}function e(){c.height="100%",l.hide(),Ti.API.info("in here"),l.top="70%"}require("alloy/controllers/BaseController").apply(this,Array.prototype.slice.call(arguments)),this.__controllerPath="mappage",arguments[0]&&(__processArg(arguments[0],"__parentSymbol"),__processArg(arguments[0],"$model"),__processArg(arguments[0],"__itemTemplate"));var i=this,r={};i.__views.mappagewin=Ti.UI.createWindow({backgroundColor:"white",id:"mappagewin"}),i.__views.mappagewin&&i.addTopLevelView(i.__views.mappagewin),r.destroy=function(){},_.extend(i,i.__views);var n=Ti.UI.createWindow(),s=require("ti.map"),o=0,a=[],l=Ti.UI.createScrollableView({showPagingControl:!1,top:"70%"}),c=s.createView({mapType:s.NORMAL_TYPE,region:{latitude:37.78739929199219,longitude:-122.4031982421875,latitudeDelta:.05,longitudeDelta:.05},animate:!0,regionFit:!0,userLocation:!1,height:"100%",top:0});n.add(c),c.addEventListener("click",function(e){var i=e.source,r=e.clicksource,n=e.annotation.title;Ti.API.info(i+" "+r+" "+n),"pin"==r&&(1!=l.getVisible()&&t(),l.scrollToView(e.annotation.myid))});var u="http://www.tvfoodmaps.com/MobileAppServlet?ACTION=gpssearch&lat=37.785835&lng=-122.406417",h=Ti.Network.createHTTPClient({onload:function(){for(var t=JSON.parse(this.responseText),i=[],r=0,u=t.results.length;u>r;r++){var h=s.createAnnotation({latitude:t.results[r].lat,longitude:t.results[r].lng,title:t.results[r].name,pincolor:s.ANNOTATION_RED,animate:!0,myid:r});a.push(h),c.addAnnotation(h);for(var d=Titanium.UI.createView({borderRadius:10,backgroundColor:"white",width:"100%",height:"100%",left:"0%",top:0}),p=Titanium.UI.createView({left:0,top:5,width:"70%",height:100,layout:"vertical"}),_=Titanium.UI.createLabel({text:t.results[r].name,left:"2%",color:"#000",width:"auto"}),f=Titanium.UI.createLabel({text:t.results[r].streetAddress,left:"2%",font:{fontSize:12},color:"#000",width:"auto"}),g=Ti.UI.createImageView({width:Ti.UI.FILL,height:100,top:5,left:"70%",image:t.results[r].mainImage}),m="As Seen On ",T=0,v=t.results[r].shows.length;v>T;T++){var y=t.results[r].shows[T].escapedShowName;m+=y,v-1>T&&(m+=" , ")}var I=Titanium.UI.createLabel({text:m,left:"2%",font:{fontSize:12},color:"#000",width:"auto"});p.add(_),p.add(f),p.add(I),d.add(p),d.add(g);var A=Titanium.UI.createView({borderRadius:10,backgroundColor:"white",width:"100%",height:"100%",left:"0%",top:100}),E=r+1,w=r+2,S=r+3,N=r+4;r+4>=u&&(E=1,w=2,S=3,N=4);var O=Ti.UI.createImageView({width:"25%",height:70,top:5,left:0,myid:E,image:t.results[E].mainImage}),x=Ti.UI.createImageView({width:"25%",height:70,top:5,left:"25%",myid:w,image:t.results[w].mainImage}),L=Ti.UI.createImageView({width:"25%",height:70,top:5,left:"50%",myid:S,image:t.results[S].mainImage}),b=Ti.UI.createImageView({width:"25%",height:70,top:5,left:"75%",myid:N,image:t.results[N].mainImage});O.addEventListener("click",function(t){l.scrollToView(t.source.myid)}),x.addEventListener("click",function(t){l.scrollToView(t.source.myid)}),L.addEventListener("click",function(t){l.scrollToView(t.source.myid)}),b.addEventListener("click",function(t){l.scrollToView(t.source.myid)}),A.add(O);var P=Titanium.UI.createLabel({text:t.results[E].name,font:{fontSize:7},top:90,left:"2%",color:"#000",width:"auto"});A.add(P),A.add(x),A.add(L),A.add(b);var R=Titanium.UI.createLabel({text:"HIDE",top:110,left:"2%",font:{fontSize:12},color:"#000",width:"auto"});R.addEventListener("click",e),A.add(R),d.add(A),i.push(d)}l.views=i,l.addEventListener("scrollend",function(t){Ti.API.info("Image Scrolled current page: "+t.currentPage),c.selectAnnotation(a[t.currentPage])}),l.addEventListener("click",function(){0==o&&(o=1,l.top="50%",c.height="50%")}),l.hide(),n.add(l)},onerror:function(){Ti.API.info("ERROR")},timeout:5e3});h.open("GET",u),h.send(),n.open(),_.extend(i,r)}var Alloy=require("alloy"),Backbone=Alloy.Backbone,_=Alloy._;module.exports=Controller;